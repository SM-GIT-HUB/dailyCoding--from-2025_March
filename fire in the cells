#include<bits/stdc++.h>

int dirs[4][2] = {{-1, 0}, {0, 1}, {1, 0}, {0, -1}};

int fireInTheCells(vector<vector<int> >& mat, int m, int n, int x, int y) {
    // Write your code here.
    auto check = [&](int x, int y) {
        if (!x || !y || x == m - 1 || y == n - 1)
        {
            if ((!x || x == m - 1) && (y && y != n - 1)) return 1;
            if ((!y || y == n - 1) && (x && x != m - 1)) return 1;
        }

        return 0;
    };

    if (check(x, y)) return 0;

    int t = 0;
    queue<pair<int, int> > q1;
    queue<pair<int, int> > q2;

    for (int i = 0; i < m; i++)
    {
        for (int j = 0; j < n; j++)
        {
            if (!mat[i][j]) q1.push({i, j});
        }
    }

    q2.push({x, y});

    while (q1.size() && q2.size())
    {
        ++t;
        int size = q1.size();
        
        while (size--)
        {
            auto [x, y] = q1.front();
            q1.pop();

            for (auto &d : dirs)
            {
                int dx = x + d[0], dy = y + d[1];

                if (dx >= 0 && dx < m && dy >= 0 && dy < n && mat[dx][dy] == 1)
                {
                    mat[dx][dy] = 0;
                    q1.push({dx, dy});
                }
            }
        }

        size = q2.size();

        while (size--)
        {
            auto [x, y] = q2.front();
            q2.pop();

            if (check(x, y)) return (t - 1);

            for (auto &d : dirs)
            {
                int dx = x + d[0], dy = y + d[1];

                if (dx >= 0 && dx < m && dy >= 0 && dy < n && mat[dx][dy] == 1) {
                    q2.push({dx, dy});
                }
            }
        }
    }

    return -1;
}
